2006-04-26  Dan Winship  <danw@novell.com>

	* plugins/gconf.c (gconfSetOption): gconf_value_compare against
	the old value for list-type options too.
	(gconfInitOption): Change the call to gconf_client_get_entry to
	request the default value again; the fix to gconfSetOption will
	prevent the infinite loops that happened before.

2006-04-26  David Reveman  <davidr@novell.com>

	* gnome/window-decorator/gnome-window-decorator.c (update_shadow): 
	Remove comment that is no longer valid.

	* plugins/move.c: Support for maximized windows snap-off. Based on
	patch by Colin Guthrie.

	* plugins/rotate.c (rotateHandleEvent): Don't do edge flipping
	when a horizontally maximized or fullscreen window is grabbed.

	* plugins/zoom.c:
	* plugins/rotate.c:
	* plugins/resize.c:
	* plugins/move.c:
	* src/screen.c:
	* include/compiz.h: Add warpPointerToScreenPos and use it everywhere
	we want to invisibly warp the pointer.

2006-04-25  David Reveman  <davidr@novell.com>

	* gnome/window-decorator/gnome-window-decorator.c:
	* plugins/decoration.c: Add clamp and min size.

	* plugins/decoration.c (decorReleaseDecoration): Fix memory leak.

	* plugins/scale.c: Click on background leaves scale mode and enters
	show desktop mode. (Dan Winship)

	* plugins/minimize.c (minHandleEvent): Initialize scale and
	translate properly.

	* src/window.c (activateWindow):
	* src/event.c (handleEvent):
	* src/screen.c: Add window parameter to leaveShowDesktopMode and
	use this function for making one window leave show desktop mode.
	Fixes so that we're leaving show desktop mode when no windows
	are longer hidden.

	* plugins/scale.c (scaleSetScreenOption): Add missing break statement.

	* plugins/rotate.c (rotateInitScreen): Initialize rotateHandle.

	* src/paint.c (paintScreen): Only paint windows that have been 
	damaged.

2006-04-24  Dan Winship  <danw@novell.com>

	* plugins/scale.c: 
	* plugins/switcher.c: clarify the "initiate" descriptions

	* plugins/compiz.schemas: regen

2006-04-24  David Reveman  <davidr@novell.com>

	* src/paint.c (paintScreen): Always call paintWindow when window
	is visible. Fixes so that window animations (fade, minimize...) aren't
	paused when if window becomes invisible.
	(paintWindow): Return early if region is empty.

	* plugins/switcher.c: Use hideWindow and showWindow so that the
	decoration doesn't have to be redrawn every time the switcher window
	is mapped.

	* src/window.c:
	* include/compiz.h: Add hidden flag, that can be used to hide windows
	without minimizing them.

	* plugins/compiz.schemas: Regen (drop-shadow options).

	* configure.ac: xrender 0.9, required for g-w-d.

	* gnome/window-decorator/gnome-window-decorator.c:
	* plugins/decoration.c: Add configurable drop-shadows. A minor issue is
	that shadows around "tiny" windows are not rendered correctly when
	large shadow offsets are used. Solution is to have the decorator set
	a minimum size for which a decoration can be used so that no shadows
	are rendered around "tiny" windows.

2006-04-20  Dan Winship  <danw@novell.com>

	* plugins/rotate.c: add 12 go-directly-to-cube-face and 12
	go-directly-to-cube-face-with-window bindings.

	* src/display.c (compDisplayInitOptions): fix the binding type on
	WINDOW_MENU.

	* plugins/compiz.schemas: Regen. (lower_window, window_menu,
	scale_image, images, resize, flip_move, move_window_types, and the
	new rotate bindings)

2006-04-20  David Reveman  <davidr@novell.com>

	* src/window.c:
	* src/event.c (handleEvent):
	* src/display.c:
	* include/compiz.h:
	* gnome/window-decorator/gnome-window-decorator.c: Add force quit
	dialog.

	* plugins/resize.c: Changed default binding to Button2.

	* src/display.c (LOWER_WINDOW_BUTTON_DEFAULT): Button2 -> 6.

	* gnome/window-decorator/gnome-window-decorator.c:
	* include/compiz.h:
	* src/event.c (handleEvent):
	* src/display.c: Add window menu binding.

	* gnome/window-decorator/gnome-window-decorator.c: Pick up toolkit
	actions from compiz and send gnome panel actions for "main menu" and
	"run dialog" actions.

	* src/event.c (handleEvent):
	* src/screen.c:
	* include/compiz.h:
	* src/display.c (addDisplay): panel action -> toolkit action.

	* src/window.c (getModalTransient): Group transient must not be an
	ancestor to the window we've currently found as the window to focus.
	(getModalTransient): Check for child modal transient.

2006-04-19  David Reveman  <davidr@novell.com>

	* gnome/compiz-window-manager.c: Be nice to gnome-theme-manager
	and return a theme even though we currently don't support it.

	* include/compiz.h:
	* src/main.c: Remove window-image option.

	* include/compiz.h:
	* plugins/water.c:
	* plugins/cube.c:
	* src/texture.c:
	* src/paint.c:
	* src/main.c: Add strict-binding option.

2006-04-18  Dan Winship  <danw@novell.com>

	* src/event.c (handleEvent): Fix a crasher in the screenshot
	binding code (and rename some of the #defines to make them not so
	ridiculously long). Also temporarily hack around a bug in EV_KEY
	by putting the check for WINDOW_SCREENSHOT before the check for
	SCREENSHOT.

	* plugins/scale.c: Change the keybinding again, now to "Pause".
	(F11 is the "fullscreen mode" binding for many apps.)

	* plugins/compiz.schemas: update

	* plugins/gconf.c: 
	* plugins/gconf-compiz-utils.c: 
	* plugins/gconf-dump.c: Rearrange #includes to prevent warning
	about TRUE and FALSE being redefined

2006-04-18  David Reveman  <davidr@novell.com>

	* plugins/rotate.c (ROTATE_FLIPMOVE_DEFAULT): Changed to TRUE.

	* src/window.c (recalcWindowActions): Remove maximize and fullscreen
	actions when resizing isn't allowed.

	* gnome/window-decorator/gnome-window-decorator.c: Dynamic positioning
	of window buttons.

	* plugins/cube.c (readSvgToTexture): Fix typo.

	* plugins/resize.c: Constrain cursor movement to min/max window size.

	* src/window.c (constrainNewWindowSize): Fix aspect ratio calculations.

2006-04-17  David Reveman  <davidr@novell.com>

	* plugins/cube.c: Put PNG on top face by default.

	* images/Makefile.am: Remove window.png.
	Add novell.png.

	* include/compiz.h:
	* src/readpng.c: Add openImageFile.

	* plugins/cube.c: Support for PNGs on top face.
	Add scale image option which is used to determine if top face
	image should be scaled or not.

2006-04-15  David Reveman  <davidr@novell.com>

	* plugins/wobbly.c: Add modal dialog type to default list of windows
	that should be wobbly when moved.

	* plugins/water.c (SET): +1 for border.

2006-04-14  Dan Winship  <danw@novell.com>

	* plugins/gconf-dump.c: add "water" to gconfDeps

	* plugins/compiz.schemas: regen including the water options

2006-04-14  David Reveman  <davidr@novell.com>

	* src/event.c (handleWindowDamageRect): Ignore damage from windows
	that aren't redirected.

	* include/compiz.h:
	* src/window.c:
	* src/display.c (eventLoop):
	* src/screen.c: Add support for automatic unredirecting of fullscreen
	windows.

	* plugins/scale.c (scaleInitiate): Layout thumbnails before we
	grab the screen to make sure some window exist.

	* plugins/resize.c: Allow 4-way resize. (Mike Hearn)

2006-04-13  Dan Winship  <danw@novell.com>

	* src/screen.c (panelAction): take a timestamp and pass that to
	the panel rather than using CurrentTime

	* src/event.c (handleEvent): update for that

	* src/window.c (moveResizeWindow): fix the gravity handling so
	self-resizing windows don't dance (although I'm pretty sure this
	is a symptom of mishandling gravity somewhere else).

	* plugins/gconf.c (gconfInitOption): Request the default value of
	the key from gconf, rather than initializing the key to the
	internal default value if it hasn't yet been set by the user.
	Notably, this makes it so that "compiz gconf" on a new account
	will use the default value of active_plugins rather than the
	(effectively empty) list of plugins on the command line. (It also
	makes it so that the sysadmin can override defaults via sabayon or
	whatever.)

2006-04-13  David Reveman  <davidr@novell.com>

	* src/window.c (mapWindow): Maybe not, disable it again. :(

	* src/window.c (mapWindow): Enable draw synchronization on map
	again. Should be working correctly with CVS version of X server.

2006-04-12  Dan Winship  <danw@novell.com>

	* src/window.c (moveResizeWindow): move duplicated code from
	_NET_MOVERESIZE_WINDOW and ConfigureRequest handlers in event.c to
	here, and handle gravity as well. (Fixes bnc 163058.)
	(updateWindowAttributes): Do nothing if the window is
	override_redirect (and remove a few now-redundant checks of that
	elsewhere). Previously we were forgetting to check
	!override_redirect in the case where the motif hints changed. (bnc
	163931)
	(getWindowUserTime): fix a cut-and-paste-o that caused a crash on
	64bit machines.

	* src/event.c (handleEvent): fix the _NET_MOVERESIZE_WINDOW bit
	manipulation to correspond to what the EWMH means rather than what
	it says, and use moveResizeWindow for that and for
	ConfigureRequest.

	* plugins/gconf-compiz-utils.c (gconfBindingToString): DTRT with
	"None" bindings.

	* gnome/window-decorator/gnome-window-decorator.c (title_event):
	if the user right-clicks on the titlebar while the context menu is
	popped up, just pop it down and eat the click, like all other
	GNOME context menus do.
	(style_changed, value_changed): Don't add decorations to
	previously-undecorated windows. (bnc 165393)

2006-04-11  David Reveman  <davidr@novell.com>

	* src/screen.c (addScreen): Fix typo.

2006-04-10  Dan Winship  <danw@novell.com>

	* src/window.c (focusWindowOnMap): new function to decide whether
	or not to focus a newly-mapped window. In addition to the old
	checks, this also checks that _NET_WM_USER_TIME isn't 0, to allow
	a window to explicitly request to not get focus.

	* src/event.c (handleEvent): use focusWindowOnMap when processing
	MapRequest.

	* plugins/rotate.c (rotateHandleEvent): fix _NET_ACTIVE_WINDOW
	handling so this doesn't interfere with focusable panel applets.

	* plugins/compiz.schemas: regen (fixing cube top/bottom color)

	* plugins/gconf-dump.c: Handle CompOptionTypeColor.

	* configure.ac: Add --enable-gconf-dump so that the gconf-dump
	plugin doesn't get built in normal builds

	* plugins/Makefile.am: make gconf-dump optional.

2006-04-09  Dan Winship  <danw@novell.com>

	* plugins/gconf-dump.c: add plugin options, and add information
	about restrictions (numeric ranges, specific string values) to the
	long description. Make gconf-dump refuse to run if gconf is
	running (since you want the defaults it writes out to be coming
	from the defaults in the source code, not from any gconf
	overrides).

	* plugins/compiz.schemas: regen

	* plugins/gconf.c (gconfGetOptionValue): don't call gconfSetOption
	from here, or we'll get an infinite loop when anything changes

2006-04-09  David Reveman  <davidr@novell.com>

	* include/compiz.h:
	* src/display.c:
	* src/main.c:
	* src/screen.c:
	* src/texture.c:
	* src/window.c: Remove test mode.

	* plugins/Makefile.am: Remove schema from CLEANFILES.

	* plugins/compiz.schemas:
	* src/display.c:
	Improve documentation for runcommand keys slightly. (Mike Hearn)

	* include/compiz.h:
	* src/texture.c:
	* src/screen.c (addScreen): Switch to using GLX 1.3 functions.
	 (James Jones)

	* src/main.c: Indirect rendering option. (James Jones)

2006-04-08  David Reveman  <davidr@novell.com>

	* plugins/water.c: Add rain delay option. (Emilie Roberts)

2006-04-07  David Reveman  <davidr@novell.com>

	* plugins/gconf-dump.c: Dump list options correctly.

	* plugins/rotate.c: Add flip_move option, edge flipping is only
	used when moving windows if this option is enabled.
	(rotateHandleEvent): Make we don't rotate when some other plugin
	has grabbed the screen.

	* plugins/scale.c: Change default key-binding to F11.
	(scaleInitiate): Make sure screen isn't grabbed by some other plugin.
	(scaleInitScreen): Initialize darkenBack properly.

	* configure.ac: Bump version to 0.0.9.

	* plugins/Makefile.am (CLEANFILES, EXTRA_DIST): Fix.

	* plugins/rotate.c (ROTATE_SPEED_DEFAULT): 1.5.

2006-04-07  Dan Winship  <danw@novell.com>

	(Much of this patch was written by Radek Doulik
	<rodo@novell.com>.)

	* src/display.c:
	* src/event.c:
	* src/screen.c: Move keybinding stuff to CompDisplay, making it no
	longer settable per-screen. Add bindings for screenshots (for
	compatibility with metacity, which handles that keybinding in
	GNOME for historical reasons).

	* include/compiz.h: add an explicit CompBindingTypeNone rather
	than relying on modifiers==0 to mean none. Update bindings stuff.

	* src/screen.c (removePassiveKeyGrab, removePassiveButtonGrab):
	Fix these to remove the right grab rather than always removing the
	most-recently-added one.
	(addScreenBinding): deal with CompBindingTypeNone

	* plugins/gconf-dump.c: hacky plugin to dump information about the
	other plugins to a gconf schemas file (used to regenerate
	compiz.schemas)

	* plugins/gconf-compiz-utils.c: shared code between gconf.c and
	gconf-dump.c

	* plugins/Makefile.am: add gconf-dump plugin and compiz.schemas,
	and code to install compiz.schemas.

	* configure.ac: Update gconf test to set macros needed for schema
	install.

2006-04-07  David Reveman  <davidr@novell.com>

	* plugins/rotate.c: Add edge flipping support.

	* plugins/scale.c: Allow corner screen edges to be used for
	initiating scale mode.

	* src/option.c (compSetBoolOption): Only return TRUE if value changed.

	* src/screen.c:
	* src/window.c:
	* plugins/minimize.c:
	* plugins/decoration.c:
	* include/compiz.h: Add immediate argument to MoveNotify, immediate
	means that any animations should be avoided.

	* src/screen.c:
	* plugins/water.c:
	* plugins/resize.c:
	* plugins/place.c:
	* plugins/move.c:
	* plugins/zoom.c:
	* plugins/rotate.c:
	* plugins/scale.c:
	* src/event.c:
	* include/compiz.h:
	Add previous pointer position that can be shared between multiple
	plugins.

2006-04-06  David Reveman  <davidr@novell.com>

	* include/compiz.h:
	* src/screen.c: Add screen edges and simple interface for enabling
	and disabling them.

	* plugins/switcher.c (switchDamageWindowRect)
	(switchWindowRemove): Update switcher list even when screen isn't
	grabbed.

	* plugins/switcher.c (switchDamageWindowRect):
	* include/compiz.h:
	* src/event.c (handleEvent):
	* src/window.c:	Made it possible to select if window should be
	stacked above fullscreen windows or not.

	* src/window.c (findSiblingBelow): Only find a fullscreen sibling
	if aboveFs is TRUE.
	(activateWindow): Allow stacking of window above fullscreen windows
	when being activated.

2006-04-05  David Reveman  <davidr@novell.com>

	* plugins/water.c (fboEpilogue): Reset raster position. Avoids
	an FBO/raster-position issue found in newer nvidia drivers.

	* plugins/move.c: Add constrain_y option that constrains window
	movement so that top of window is always visible (on by default).

	* src/event.c (handleEvent): Change active window property even though
	it's not different than the window we currently have as active.

	* src/window.c (moveInputFocusToWindow): Set focus even though
	the window is considered the active window.

2006-04-03  David Reveman  <davidr@novell.com>

	* plugins/water.c: Use char everywhere instead.
	Fix offset direction (P-a Bäckström).
	Add offset scale option.

	* plugins/water.c: (loadFragmentProgram): GLubyte -> const GLbyte.
	(loadWaterProgram): char -> GLbyte.
	(loadBumpMapProgram): char -> GLbyte.
	Use char everywhere.

	* configure.ac: Bump version to 0.0.8.

	* plugins/water.c: Add simple rain effect.
	(loadFragmentProgram): Clear any previous error.

	* src/display.c: Change so that timeouts are not only triggered
	when we're idle.

2006-04-02  David Reveman  <davidr@novell.com>

	* plugins/water.c: Add scale and bias to normal so that light can be
	computed correclty. Offset texture coordinates for nice refraction
	effect. (P-a Bäckström)
	(waterDrawWindowTexture): Add scaling after setting up texture
	coordinate generation.
	Fix up loading of bump map programs.
	(softwareUpdate): Improve performance of software fall-back code a bit.
	(waterDrawWindowTexture): Always use filter for when window is
	transformed.

	* plugins/gconf.c (gconfGetValue): Fix typo that caused color
	parsing to be incomplete (Quinn Storm).

2006-04-01  David Reveman  <davidr@novell.com>

	* plugins/switcher.c: Add "initiate all" binding which brings up the
	switcher window with all mapped windows and "initiate" binding will
	now bring up the switcher window with only the visible windows.

2006-03-31  David Reveman  <davidr@novell.com>

	* plugins/minimize.c (minDamageWindowRect): Never leave windows
	in scaled state.

	* src/screen.c (moveScreenViewport): Move hidden windows as well.

	* src/window.c (addWindow, activateWindow, hideWindow)
	(showWindow):
	* src/screen.c (enterShowDesktopMode, leaveShowDesktopMode):
	* src/event.c (handleEvent):
	* include/compiz.h: Fix up show desktop mode.

	* plugins/water.c (fboVertices): return 1.

2006-03-30  David Reveman  <davidr@novell.com>

	* src/texture.c (enableTexture): Always make sure mipmaps are up to
	date when using GL_LINEAR_MIPMAP_LINEAR filter.

2006-03-29  David Reveman  <davidr@novell.com>

	* gnome/window-decorator/gnome-window-decorator.c: Draw outline around
	window title text and buttons instead of small shadow.

	* src/event.c (handleEvent):
	* include/compiz.h:
	* src/window.c: Set allowed window actions more correctly.

	* plugins/move.c: Add opacity option.

	* plugins/Makefile.am: Add water plugin. It's not very useful yet
	and it needs more work but it's a good example of how to use
	GL_ARB_fragment_program and GL_EXT_framebuffer_object for visual
	effects.

	* src/screen.c (addScreen): Fix light position.

	* src/paint.c (paintWindow):
	* plugins/switcher.c (switchPaintThumb):
	* plugins/decoration.c (decorPaintWindow):
	* include/compiz.h: Make drawWindowTexture a screen function so that
	plugins can wrap it.

	* src/texture.c (enableTexture):
	* src/screen.c (addScreen):
	* include/compiz.h: GL_EXT_framebuffer_object and
	GL_ARB_fragment_program support.

2006-03-21  David Reveman  <davidr@novell.com>

	* gnome/window-decorator/gnome-window-decorator.c (lower_window): Don't
	try to lower a window below hidden windows or desktop windows.

2006-03-20  David Reveman  <davidr@novell.com>

	* plugins/wobbly.c (wobblyHandleEvent):
	xunmap -> xmap (François Ingelrest).

	* src/screen.c (isClientListWindow): All type of windows should go into
	the client lists (Thanks to Quinn Storm).

	* src/window.c (freeWindow): Destroy frame window.
	(mapWindow): Fix so the sync requests are sent correctly when a window
	is mapped but disable it for now as it seems to be causing problems
	with some applications.
	(recalcWindowActions): Allow dialog window actions on util and
	toolbar windows.

	* src/event.c (handleEvent): Remove event mask and button grabs
	when window is reparented.
	(handleEvent): Update client list when window type changes.
	(handleEvent): Use constrainNewWindowSize on move/resize client
	messages and configure requests.

	* gnome/window-decorator/gnome-window-decorator.c (window_closed):
	Delete decor property when window is closed.

2006-03-17  Jeremy C. Reed  <reed@reedmedia.net>

	reviewed by: David Reveman

	* autogen.sh:
	Be consistent with rest of modular xorg by using same
	autogen.sh.  This allows it to be run using a different
	work directory.

2006-03-17  Jeremy C. Reed  <reed@reedmedia.net>

	reviewed by: David Reveman

	* INSTALL:
	Mention startup-notification requirement.

2006-03-17  David Reveman  <davidr@novell.com>

	* plugins/scale.c: Add opacity option.

	* configure.ac: Bump version to 0.0.7.

2006-03-17  Radek Doulik  <rodo@novell.com>

	* src/session.c: added all mandatory SM client callbacks, handle
	ICE connection and process ICE messages

	* src/display.c (compAddWatchFd): new function, adds new fd watch
	- for poll io multiplexing
	(compRemoveWatchFd): new function, remove fd watch added by
	compAddWatchFd
	(doPoll): new helper function, does call poll and calls callbacks
	for watch fd's. returns the value of poll call
	(eventLoop): use doPoll, we use NULL for display fd watch so that
	it doesn't call anything and just use return value from poll as
	before

2006-03-17  David Reveman  <davidr@novell.com>

	* plugins/switcher.c (switchDamageWindowRect): Update window
	attributes for popup window. We never get a MapRequest for this
	window so it most be done here.
	Add "bring to front" option. (Greg)

	* src/window.c (stackAncestors): Never raise desktop windows.
	Made restackWindowAbove and restackWindowBelow smarter.

2006-03-16  David Reveman  <davidr@novell.com>

	* plugins/minimize.c:
	* src/event.c (handleEvent):
	* src/window.c:
	Handle window state changes correctly.
	(maximizeWindow): Use actions to determine if we're allowed maximize
	window.

	* src/event.c (handleEvent):
	* src/window.c: Send configure notifies correctly.

2006-03-15  David Reveman  <davidr@novell.com>

	* plugins/switcher.c (switchPaintWindow): Fix paint attribute
	calculations.

	* include/compiz.h:
	* src/event.c (handleEvent):
	* src/window.c: Add restackWindowBelow.

2006-03-14  David Reveman  <davidr@novell.com>

	* plugins/switcher.c: Opacity, brightness and saturation as adjustable
	options. (Greg)

	* src/window.c (syncWindowPosition): Move frame window now instead of
	waiting for client window to change before moving it.

	* plugins/move.c (moveTerminate): Sync window position before
	releasing pointer grab so that the EnterNotify event from the release
	go to the correct window.

	* src/window.c (unmapWindow): Put window in withdrawn state when
	being unmapped. Should make it work better with KDE. (Tim Northover)

	* src/screen.c (addScreen): Fix ambient and diffuse light.

	* src/main.c (main): Add --version command line option.

	* src/event.c:
	* src/screen.c:
	* include/compiz.h: Add bindings for changing window opacity.

2006-03-14  Radek Doulik  <rodo@novell.com>

	* src/event.c (handleEvent): handle minimize/maximize/unmaximize
	window keybindings

	* src/screen.c: added minimize/maximize/unmaximize window
	options/keybindings

	* src/window.c (maximizeWindow): new helper function
	(unmaximizeWindow): ditto

2006-03-14  David Reveman  <davidr@novell.com>

	* plugins/scale.c: Add darken background option (Daniel G. Taylor).

2006-03-13  David Reveman  <davidr@novell.com>

	* src/display.c (eventLoop):
	* include/compiz.h:
	* src/screen.c (addScreen): CopySubBufferMESA support.

2006-03-07  David Reveman  <davidr@novell.com>

	* gnome/window-decorator/gnome-window-decorator.c (lower_window):
	Remove unused variable tmp.

	* src/event.c:
	* src/display.c:
	* src/window.c:
	* src/screen.c:
	* include/compiz.h: Better window stacking support.

	* gnome/window-decorator/gnome-window-decorator.c: Lower window
	when clicking button 2 on titlebar.

	* src/window.c (ensureWindowVisibility): Only ensure that window is
	visible if it isn't a override redirect window, dock window or
	window with struts.

2006-03-06  David Reveman  <davidr@novell.com>

	* configure.ac: Bump version to 0.0.6.

	* plugins/cube.c: Skydome update. (MacSlow)

	* src/window.c: Ensure window visibility when activating window.

2006-03-05  David Reveman  <davidr@novell.com>

	* src/window.c (closeWindow): Use protocol mask to determine if
	Client Message should be send or if we should kill the client.

	* plugins/decoration.c: Don't draw shadow only decorations around
	windows with alpha channel.

2006-03-03  David Reveman  <davidr@novell.com>

	* src/texture.c (readImageBufferToTexture):
	(readImageToTexture): Check that returnWidth and returnHeight are
	not NULL.

	* plugins/cube.c: Skydome support. Thanks to MacSlow.

	* plugins/fade.c (fadeHandleEvent): Make sure opacity isn't opaque
	when fading out.
	Stop fading if window is resized.

	* src/window.c (resizeWindow): Only verify pixmap size if window is
	mapped.
	(resizeWindow): Check XGetGeometry result.

	* plugins/switcher.c: Make sure switcher is correctly updated
	even though the previously selected window isn't selectable by
	switcher.

	* src/event.c (handleEvent): Avoid panel actions when screen is
	grabbed.

2006-03-03  Radek Doulik  <rodo@novell.com>

	* src/main.c (main): init and close session when sm is not
	disabled. Enable sm by default.

	* src/session.c: added minimal session support so that compiz at
	least register with session manager to avoid registering timeouts

2006-03-03  David Reveman  <davidr@novell.com>

	* src/screen.c (removeScreenGrab): Use correct cursor when changing
	actvie pointer grab.

2006-03-02  David Reveman  <davidr@novell.com>

	* plugins/rotate.c (rotateHandleEvent):
	* plugins/zoom.c (zoomHandleEvent): Make sure no pending motion
	notify events exists when warping the pointer.

	* plugins/rotate.c (rotateHandleEvent): Reset movement.

	* plugins/switcher.c: Always send activate request when selecting a
	window.

	* plugins/cube.c (cubePaintTransformedScreen): Reset color.

	* plugins/switcher.c (switchPaintThumb): PAINT_WINDOW_TRANSLUCENT_MASK
	if opacity isn't opaque.
	(switchPaintWindow): Reset color.

2006-03-01  David Reveman  <davidr@novell.com>

	* configure.ac: Bump version to 0.0.5.

	* plugins/fade.c (fadeAddDisplayModal): Higher brightness when showing
	display modal dialogs.

	* plugins/switcher.c (switchPreparePaintScreen): Continue adjusting
	window selection even though we're not grabbing the screen.
	(switchPaintWindow): Use last used paint attributes for thumbnails.
	(switchPaintWindow): Use blending when drawing selection rectangle.

	* plugins/fade.c (fadeHandleEvent): unmap. -> map.
	(fadeDamageWindowRect): Only zero opacity if we're not already
	fading the window.

	* src/window.c (unmapWindow): 'placed' variable should be reset on
	first call to unmapWindow.

	* src/screen.c:
	* src/event.c (handleEvent):
	* src/display.c (eventLoop):
	* include/compiz.h: Add slow animation option.

	* src/window.c (recalcNormalHints): Constrain window dimensions to
	max texture size.

	* src/screen.c (addScreen): Get max texture size.

	* gnome/window-decorator/gnome-window-decorator.c: Nicer drop shadow
	on windows without decorations.

	* src/window.c (addWindow): Move initialization of sync alarm.

	* plugins/cube.c:
	* plugins/decoration.c:
	(decorCreateDecoration): Fix minimum size check.

	* src/main.c:
	* include/compiz.h:
	* src/paint.c:
	* src/screen.c: Ligthing support.

	* compiz.pc.in: Fix.

2006-02-23  David Reveman  <davidr@novell.com>

	* src/window.c (unmapWindow): Not minimized and not part of showing
	desktop mode.

	* plugins/wobbly.c: Fix handling of scaled windows.
	Update options so that user gets more control over which windows
	that should wobble and when.

	* configure.ac: Bump version to 0.0.4.

	* gnome/window-decorator/gnome-window-decorator.c (window_opened): Make
	sure decoration property for switcher window is set.

	* plugins/decoration.c (decorHandleEvent):
	* src/event.c (handleEvent):
	* plugins/switcher.c:
	* src/screen.c (addScreen, setScreenOption)
	(compScreenInitOptions):
	* src/texture.c:
	* include/compiz.h: Mipmap support. Add more RUN_COMMAND options.

2006-02-22  David Reveman  <davidr@novell.com>

	* src/display.c (realToVirtualModMask): Remove modifiers that should
	be ignored.
	(addDisplay): Select ButtonPress and ButtonRelease events on root
	window.

	* include/compiz.h (EV_KEY):
	(EV_BUTTON):  Modifiers should match exactly.

	* plugins/switcher.c: Add binding for selecting previous window.

	* plugins/decoration.c: Remove sync hack.

	* gnome/window-decorator/gnome-window-decorator.c
	(draw_shadow_background): Fix drawing of bottom and bottom right
	shadow rectangle.
	Add switcher window decorations.
	Remove sync hack.
	Always use double buffering.

	* plugins/switcher.c: Remove background color option.
	Use property instead of client message to indicate change of selected
	window.

2006-02-21  David Reveman  <davidr@novell.com>

	* plugins/cube.c (cubeHandleEvent): Only load new SVG when available.

2006-02-20  David Reveman  <davidr@novell.com>

	* plugins/decoration.c (decorWindowUpdate): Decorate window
	MwmDecorTitle is present.

	* src/window.c (focusWindow):
	(moveInputFocusToWindow):
	 Allow focusing windows with input hint set to false.
	 (activateWindow): Fix so that dock windows can be active.

	* src/screen.c (isClientListWindow): Don't put destroyed windows in
	client lists.

	* src/event.c (handleEvent): Fix so that dock windows can be active.
	(handleEvent): Avoid focusing windows with input hint set to false
	when mapped.

2006-02-18  David Reveman  <davidr@novell.com>

	* src/window.c (unmapWindow): Windows not being minimized should be
	placed again at next map.

	* plugins/wobbly.c (wobblyDonePaintScreen): Also add pending damage
	if any window is in initial wobbly state.

2006-02-17  David Reveman  <davidr@novell.com>

	* configure.ac: Bump version to 0.0.3.

	* plugins/zoom.c (zoomIn): Translate less.
	(zoomPaintScreen): Use selected filter.
	(adjustZoomVelocity): Made zoom animation nicer.
	(zoomPreparePaintScreen): Don't zoom to much.
	ADd filter selection option.

	* plugins/decoration.c (decorPaintWindow):
	* src/paint.c (drawWindowTexture): Use screen filters.

	* include/compiz.h: Add support for adjusting filters.

	* plugins/scale.c (scaleHandleEvent): Only button 1.

	* plugins/cube.c (cubePaintTransformedScreen): Fix drawing with size
	 greater than 4.

2006-02-16  David Reveman  <davidr@novell.com>

	* configure.ac: Remove menu.

	* plugins/switcher.c (switchNextWindow): Damage new and previously
	selected window.
	(switchInitiate): Damage screen initiating switching.
	(switchTerminate): Damage screen terminating switching.
	(switchPaintThumb): Draw thumbnail without calling any function that
	can be wrapped.

	* gnome/window-decorator/gnome-window-decorator.c
	(update_window_decoration_size): Make sure title isn't rendered
	when it doesn't fit.

2006-02-14  David Reveman  <davidr@novell.com>

	* gnome/window-decorator/gnome-window-decorator.c
	(draw_window_decoration): Make sure complete icon is visible.

	* src/display.c (eventLoop):
	(getTimeToNextRedraw): Handle clock rollback.

2006-02-13  David Reveman  <davidr@novell.com>

	* configure.ac: Remove menu plugin check.
	Require version 2.8.0 or greater of gtk+.

2006-02-11  David Reveman  <davidr@novell.com>

	* configure.ac: Bump version to 0.0.2.

	* src/window.c:
	* src/event.c:
	* plugins/fade.c:
	* src/display.c:
	* include/compiz.h: Lower brightness of windows that are not responding
	and all windows when showing logout dialog.

	* gnome/window-decorator/gnome-window-decorator.c: Use metacity
	titlebar font settings.

	* gnome/compiz-window-manager.c: Add titlebar font setting.

	* plugins/Makefile.am:
	* plugins/switcher.c: Add switcher plugin.

	* plugins/gconf.c: Add alpha to color options.

2006-02-10  David Reveman  <davidr@novell.com>

	* src/screen.c:
	* src/display.c: Do not include X11/extensions/Xevie.h.
