2006-04-02  David Reveman  <davidr@novell.com>

	* plugins/water.c: Add scale and bias to normal so that light can be
	computed correclty. Offset texture coordinates for nice refraction
	effect. (P-a Bäckström)
	(waterDrawWindowTexture): Add scaling after setting up texture
	coordinate generation.
	Fix up loading of bump map programs.
	(softwareUpdate): Improve performance of software fall-back code a bit.
	(waterDrawWindowTexture): Always use filter for when window is
	transformed.

	* plugins/gconf.c (gconfGetValue): Fix typo that caused color
	parsing to be incomplete (Quinn Storm).

2006-04-01  David Reveman  <davidr@novell.com>

	* plugins/switcher.c: Add "initiate all" binding which brings up the
	switcher window with all mapped windows and "initiate" binding will
	now bring up the switcher window with only the visible windows.

2006-03-31  David Reveman  <davidr@novell.com>

	* plugins/minimize.c (minDamageWindowRect): Never leave windows
	in scaled state.

	* src/screen.c (moveScreenViewport): Move hidden windows as well.

	* src/window.c (addWindow, activateWindow, hideWindow)
	(showWindow):
	* src/screen.c (enterShowDesktopMode, leaveShowDesktopMode):
	* src/event.c (handleEvent):
	* include/compiz.h: Fix up show desktop mode.

	* plugins/water.c (fboVertices): return 1.

2006-03-30  David Reveman  <davidr@novell.com>

	* src/texture.c (enableTexture): Always make sure mipmaps are up to
	date when using GL_LINEAR_MIPMAP_LINEAR filter.

2006-03-29  David Reveman  <davidr@novell.com>

	* gnome/window-decorator/gnome-window-decorator.c: Draw outline around
	window title text and buttons instead of small shadow.

	* src/event.c (handleEvent):
	* include/compiz.h:
	* src/window.c: Set allowed window actions more correctly.

	* plugins/move.c: Add opacity option.

	* plugins/Makefile.am: Add water plugin. It's not very useful yet
	and it needs more work but it's a good example of how to use
	GL_ARB_fragment_program and GL_EXT_framebuffer_object for visual
	effects.

	* src/screen.c (addScreen): Fix light position.

	* src/paint.c (paintWindow):
	* plugins/switcher.c (switchPaintThumb):
	* plugins/decoration.c (decorPaintWindow):
	* include/compiz.h: Make drawWindowTexture a screen function so that
	plugins can wrap it.

	* src/texture.c (enableTexture):
	* src/screen.c (addScreen):
	* include/compiz.h: GL_EXT_framebuffer_object and
	GL_ARB_fragment_program support.

2006-03-21  David Reveman  <davidr@novell.com>

	* gnome/window-decorator/gnome-window-decorator.c (lower_window): Don't
	try to lower a window below hidden windows or desktop windows.

2006-03-20  David Reveman  <davidr@novell.com>

	* plugins/wobbly.c (wobblyHandleEvent):
	xunmap -> xmap (François Ingelrest).

	* src/screen.c (isClientListWindow): All type of windows should go into
	the client lists (Thanks to Quinn Storm).

	* src/window.c (freeWindow): Destroy frame window.
	(mapWindow): Fix so the sync requests are sent correctly when a window
	is mapped but disable it for now as it seems to be causing problems
	with some applications.
	(recalcWindowActions): Allow dialog window actions on util and
	toolbar windows.

	* src/event.c (handleEvent): Remove event mask and button grabs
	when window is reparented.
	(handleEvent): Update client list when window type changes.
	(handleEvent): Use constrainNewWindowSize on move/resize client
	messages and configure requests.

	* gnome/window-decorator/gnome-window-decorator.c (window_closed):
	Delete decor property when window is closed.

2006-03-17  Jeremy C. Reed  <reed@reedmedia.net>

	reviewed by: David Reveman

	* autogen.sh:
	Be consistent with rest of modular xorg by using same
	autogen.sh.  This allows it to be run using a different
	work directory.

2006-03-17  Jeremy C. Reed  <reed@reedmedia.net>

	reviewed by: David Reveman

	* INSTALL:
	Mention startup-notification requirement.

2006-03-17  David Reveman  <davidr@novell.com>

	* plugins/scale.c: Add opacity option.

	* configure.ac: Bump version to 0.0.7.

2006-03-17  Radek Doulik  <rodo@novell.com>

	* src/session.c: added all mandatory SM client callbacks, handle
	ICE connection and process ICE messages

	* src/display.c (compAddWatchFd): new function, adds new fd watch
	- for poll io multiplexing
	(compRemoveWatchFd): new function, remove fd watch added by
	compAddWatchFd
	(doPoll): new helper function, does call poll and calls callbacks
	for watch fd's. returns the value of poll call
	(eventLoop): use doPoll, we use NULL for display fd watch so that
	it doesn't call anything and just use return value from poll as
	before

2006-03-17  David Reveman  <davidr@novell.com>

	* plugins/switcher.c (switchDamageWindowRect): Update window
	attributes for popup window. We never get a MapRequest for this
	window so it most be done here.
	Add "bring to front" option. (Greg)

	* src/window.c (stackAncestors): Never raise desktop windows.
	Made restackWindowAbove and restackWindowBelow smarter.

2006-03-16  David Reveman  <davidr@novell.com>

	* plugins/minimize.c:
	* src/event.c (handleEvent):
	* src/window.c:
	Handle window state changes correctly.
	(maximizeWindow): Use actions to determine if we're allowed maximize
	window.

	* src/event.c (handleEvent):
	* src/window.c: Send configure notifies correctly.

2006-03-15  David Reveman  <davidr@novell.com>

	* plugins/switcher.c (switchPaintWindow): Fix paint attribute
	calculations.

	* include/compiz.h:
	* src/event.c (handleEvent):
	* src/window.c: Add restackWindowBelow.

2006-03-14  David Reveman  <davidr@novell.com>

	* plugins/switcher.c: Opacity, brightness and saturation as adjustable
	options. (Greg)

	* src/window.c (syncWindowPosition): Move frame window now instead of
	waiting for client window to change before moving it.

	* plugins/move.c (moveTerminate): Sync window position before
	releasing pointer grab so that the EnterNotify event from the release
	go to the correct window.

	* src/window.c (unmapWindow): Put window in withdrawn state when
	being unmapped. Should make it work better with KDE. (Tim Northover)

	* src/screen.c (addScreen): Fix ambient and diffuse light.

	* src/main.c (main): Add --version command line option.

	* src/event.c:
	* src/screen.c:
	* include/compiz.h: Add bindings for changing window opacity.

2006-03-14  Radek Doulik  <rodo@novell.com>

	* src/event.c (handleEvent): handle minimize/maximize/unmaximize
	window keybindings

	* src/screen.c: added minimize/maximize/unmaximize window
	options/keybindings

	* src/window.c (maximizeWindow): new helper function
	(unmaximizeWindow): ditto

2006-03-14  David Reveman  <davidr@novell.com>

	* plugins/scale.c: Add darken background option (Daniel G. Taylor).

2006-03-13  David Reveman  <davidr@novell.com>

	* src/display.c (eventLoop):
	* include/compiz.h:
	* src/screen.c (addScreen): CopySubBufferMESA support.

2006-03-07  David Reveman  <davidr@novell.com>

	* gnome/window-decorator/gnome-window-decorator.c (lower_window):
	Remove unused variable tmp.

	* src/event.c:
	* src/display.c:
	* src/window.c:
	* src/screen.c:
	* include/compiz.h: Better window stacking support.

	* gnome/window-decorator/gnome-window-decorator.c: Lower window
	when clicking button 2 on titlebar.

	* src/window.c (ensureWindowVisibility): Only ensure that window is
	visible if it isn't a override redirect window, dock window or
	window with struts.

2006-03-06  David Reveman  <davidr@novell.com>

	* configure.ac: Bump version to 0.0.6.

	* plugins/cube.c: Skydome update. (MacSlow)

	* src/window.c: Ensure window visibility when activating window.

2006-03-05  David Reveman  <davidr@novell.com>

	* src/window.c (closeWindow): Use protocol mask to determine if
	Client Message should be send or if we should kill the client.

	* plugins/decoration.c: Don't draw shadow only decorations around
	windows with alpha channel.

2006-03-03  David Reveman  <davidr@novell.com>

	* src/texture.c (readImageBufferToTexture):
	(readImageToTexture): Check that returnWidth and returnHeight are
	not NULL.

	* plugins/cube.c: Skydome support. Thanks to MacSlow.

	* plugins/fade.c (fadeHandleEvent): Make sure opacity isn't opaque
	when fading out.
	Stop fading if window is resized.

	* src/window.c (resizeWindow): Only verify pixmap size if window is
	mapped.
	(resizeWindow): Check XGetGeometry result.

	* plugins/switcher.c: Make sure switcher is correctly updated
	even though the previously selected window isn't selectable by
	switcher.

	* src/event.c (handleEvent): Avoid panel actions when screen is
	grabbed.

2006-03-03  Radek Doulik  <rodo@novell.com>

	* src/main.c (main): init and close session when sm is not
	disabled. Enable sm by default.

	* src/session.c: added minimal session support so that compiz at
	least register with session manager to avoid registering timeouts

2006-03-03  David Reveman  <davidr@novell.com>

	* src/screen.c (removeScreenGrab): Use correct cursor when changing
	actvie pointer grab.

2006-03-02  David Reveman  <davidr@novell.com>

	* plugins/rotate.c (rotateHandleEvent):
	* plugins/zoom.c (zoomHandleEvent): Make sure no pending motion
	notify events exists when warping the pointer.

	* plugins/rotate.c (rotateHandleEvent): Reset movement.

	* plugins/switcher.c: Always send activate request when selecting a
	window.

	* plugins/cube.c (cubePaintTransformedScreen): Reset color.

	* plugins/switcher.c (switchPaintThumb): PAINT_WINDOW_TRANSLUCENT_MASK
	if opacity isn't opaque.
	(switchPaintWindow): Reset color.

2006-03-01  David Reveman  <davidr@novell.com>

	* configure.ac: Bump version to 0.0.5.

	* plugins/fade.c (fadeAddDisplayModal): Higher brightness when showing
	display modal dialogs.

	* plugins/switcher.c (switchPreparePaintScreen): Continue adjusting
	window selection even though we're not grabbing the screen.
	(switchPaintWindow): Use last used paint attributes for thumbnails.
	(switchPaintWindow): Use blending when drawing selection rectangle.

	* plugins/fade.c (fadeHandleEvent): unmap. -> map.
	(fadeDamageWindowRect): Only zero opacity if we're not already
	fading the window.

	* src/window.c (unmapWindow): 'placed' variable should be reset on
	first call to unmapWindow.

	* src/screen.c:
	* src/event.c (handleEvent):
	* src/display.c (eventLoop):
	* include/compiz.h: Add slow animation option.

	* src/window.c (recalcNormalHints): Constrain window dimensions to
	max texture size.

	* src/screen.c (addScreen): Get max texture size.

	* gnome/window-decorator/gnome-window-decorator.c: Nicer drop shadow
	on windows without decorations.

	* src/window.c (addWindow): Move initialization of sync alarm.

	* plugins/cube.c:
	* plugins/decoration.c:
	(decorCreateDecoration): Fix minimum size check.

	* src/main.c:
	* include/compiz.h:
	* src/paint.c:
	* src/screen.c: Ligthing support.

	* compiz.pc.in: Fix.

2006-02-23  David Reveman  <davidr@novell.com>

	* src/window.c (unmapWindow): Not minimized and not part of showing
	desktop mode.

	* plugins/wobbly.c: Fix handling of scaled windows.
	Update options so that user gets more control over which windows
	that should wobble and when.

	* configure.ac: Bump version to 0.0.4.

	* gnome/window-decorator/gnome-window-decorator.c (window_opened): Make
	sure decoration property for switcher window is set.

	* plugins/decoration.c (decorHandleEvent):
	* src/event.c (handleEvent):
	* plugins/switcher.c:
	* src/screen.c (addScreen, setScreenOption)
	(compScreenInitOptions):
	* src/texture.c:
	* include/compiz.h: Mipmap support. Add more RUN_COMMAND options.

2006-02-22  David Reveman  <davidr@novell.com>

	* src/display.c (realToVirtualModMask): Remove modifiers that should
	be ignored.
	(addDisplay): Select ButtonPress and ButtonRelease events on root
	window.

	* include/compiz.h (EV_KEY):
	(EV_BUTTON):  Modifiers should match exactly.

	* plugins/switcher.c: Add binding for selecting previous window.

	* plugins/decoration.c: Remove sync hack.

	* gnome/window-decorator/gnome-window-decorator.c
	(draw_shadow_background): Fix drawing of bottom and bottom right
	shadow rectangle.
	Add switcher window decorations.
	Remove sync hack.
	Always use double buffering.

	* plugins/switcher.c: Remove background color option.
	Use property instead of client message to indicate change of selected
	window.

2006-02-21  David Reveman  <davidr@novell.com>

	* plugins/cube.c (cubeHandleEvent): Only load new SVG when available.

2006-02-20  David Reveman  <davidr@novell.com>

	* plugins/decoration.c (decorWindowUpdate): Decorate window
	MwmDecorTitle is present.

	* src/window.c (focusWindow):
	(moveInputFocusToWindow):
	 Allow focusing windows with input hint set to false.
	 (activateWindow): Fix so that dock windows can be active.

	* src/screen.c (isClientListWindow): Don't put destroyed windows in
	client lists.

	* src/event.c (handleEvent): Fix so that dock windows can be active.
	(handleEvent): Avoid focusing windows with input hint set to false
	when mapped.

2006-02-18  David Reveman  <davidr@novell.com>

	* src/window.c (unmapWindow): Windows not being minimized should be
	placed again at next map.

	* plugins/wobbly.c (wobblyDonePaintScreen): Also add pending damage
	if any window is in initial wobbly state.

2006-02-17  David Reveman  <davidr@novell.com>

	* configure.ac: Bump version to 0.0.3.

	* plugins/zoom.c (zoomIn): Translate less.
	(zoomPaintScreen): Use selected filter.
	(adjustZoomVelocity): Made zoom animation nicer.
	(zoomPreparePaintScreen): Don't zoom to much.
	ADd filter selection option.

	* plugins/decoration.c (decorPaintWindow):
	* src/paint.c (drawWindowTexture): Use screen filters.

	* include/compiz.h: Add support for adjusting filters.

	* plugins/scale.c (scaleHandleEvent): Only button 1.

	* plugins/cube.c (cubePaintTransformedScreen): Fix drawing with size
	 greater than 4.

2006-02-16  David Reveman  <davidr@novell.com>

	* configure.ac: Remove menu.

	* plugins/switcher.c (switchNextWindow): Damage new and previously
	selected window.
	(switchInitiate): Damage screen initiating switching.
	(switchTerminate): Damage screen terminating switching.
	(switchPaintThumb): Draw thumbnail without calling any function that
	can be wrapped.

	* gnome/window-decorator/gnome-window-decorator.c
	(update_window_decoration_size): Make sure title isn't rendered
	when it doesn't fit.

2006-02-14  David Reveman  <davidr@novell.com>

	* gnome/window-decorator/gnome-window-decorator.c
	(draw_window_decoration): Make sure complete icon is visible.

	* src/display.c (eventLoop):
	(getTimeToNextRedraw): Handle clock rollback.

2006-02-13  David Reveman  <davidr@novell.com>

	* configure.ac: Remove menu plugin check.
	Require version 2.8.0 or greater of gtk+.

2006-02-11  David Reveman  <davidr@novell.com>

	* configure.ac: Bump version to 0.0.2.

	* src/window.c:
	* src/event.c:
	* plugins/fade.c:
	* src/display.c:
	* include/compiz.h: Lower brightness of windows that are not responding
	and all windows when showing logout dialog.

	* gnome/window-decorator/gnome-window-decorator.c: Use metacity
	titlebar font settings.

	* gnome/compiz-window-manager.c: Add titlebar font setting.

	* plugins/Makefile.am:
	* plugins/switcher.c: Add switcher plugin.

	* plugins/gconf.c: Add alpha to color options.

2006-02-10  David Reveman  <davidr@novell.com>

	* src/screen.c:
	* src/display.c: Do not include X11/extensions/Xevie.h.
